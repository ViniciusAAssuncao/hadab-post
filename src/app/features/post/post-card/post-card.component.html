<article
  (click)="onPostClick()"
  class="p-4 flex space-x-4 hover:bg-black/5 dark:hover:bg-white/5 transition-colors duration-200 cursor-pointer"
  [class.border-b]="!isLast"
  [class.border-gray-200]="!isLast"
  [class.dark:border-gray-800]="!isLast">
  <div class="flex-shrink-0">
    <img
      [src]="post.author?.avatarUrl"
      [alt]="post.author?.name"
      class="w-10 h-10 rounded-full object-cover bg-gray-200"
      onerror="this.src='assets/default-avatar.png';this.onerror=null;">
  </div>

  <div class="flex-1 min-w-0">
    <app-post-author [post]="post"></app-post-author>

    <div class="mt-1 space-y-2 text-gray-800 dark:text-gray-200">
      <h2
        *ngIf="post.title"
        class="font-bold text-black dark:text-white text-base leading-tight">
    {{ post.title }}
  </h2>

      <div *ngIf="post.content">
        <p
          class="text-sm leading-relaxed"
          [class.line-clamp-3]="!isExpanded && isLongContent"
          [innerHTML]="post.content | nl2br"></p>

        <button
          *ngIf="isLongContent"
          (click)="isExpanded = !isExpanded; $event.stopPropagation()"
          class="text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium mt-1">
          {{ isExpanded ? 'Ler menos' : 'Ler mais' }}
        </button>
      </div>
    </div>

    <div
      *ngIf="post.imageUrl"
      class="mt-3 relative rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden">
      <img
        [src]="post.imageUrl"
        [alt]="post.title || 'Imagem do post'"
        class="w-full h-auto object-cover"
        loading="lazy"
        onerror="this.style.display='none';this.onerror=null;">
    </div>

    <div class="mt-4">
      <app-post-stats
        [stats]="post.stats!"
        [postId]="post.id"
        (interaction)="onInteraction($event)"></app-post-stats>
    </div>
  </div>
</article>
